void d2UdF2(double f00, double f01, double f02, double f10, double f11, double f12, double f20, double f21, double f22, double lambda, double mu, MatrixXd& out) {
    const double x0 = pow(f00, 2);
    const double x1 = pow(f01, 2);
    const double x2 = pow(f10, 2);
    const double x3 = x1 + x2;
    const double x4 = pow(f20, 2);
    const double x5 = pow(f02, 2);
    const double x6 = x5 - 1;
    const double x7 = x4 + x6;
    const double x8 = pow(f12, 2);
    const double x9 = pow(f22, 2);
    const double x10 = pow(f21, 2);
    const double x11 = pow(f11, 2);
    const double x12 = x0 + x11;
    const double x13 = x10 + x12;
    const double x14 = (1.0/2.0)*lambda*(x13 + x3 + x4 + x5 + x8 + x9 - 3);
    const double x15 = f00*f01;
    const double x16 = f10*f11;
    const double x17 = f20*f21;
    const double x18 = lambda*x15 + mu*(2*x15 + x16 + x17);
    const double x19 = f00*f02;
    const double x20 = f10*f12;
    const double x21 = f20*f22;
    const double x22 = lambda*x19 + mu*(2*x19 + x20 + x21);
    const double x23 = f00*f10;
    const double x24 = f01*f11;
    const double x25 = f02*f12;
    const double x26 = lambda*x23 + mu*(2*x23 + x24 + x25);
    const double x27 = f00*lambda;
    const double x28 = f10*mu;
    const double x29 = f01*x28 + f11*x27;
    const double x30 = f02*x28 + f12*x27;
    const double x31 = f00*f20;
    const double x32 = f01*f21;
    const double x33 = f02*f22;
    const double x34 = lambda*x31 + mu*(2*x31 + x32 + x33);
    const double x35 = f20*mu;
    const double x36 = f01*x35 + f21*x27;
    const double x37 = f02*x35 + f22*x27;
    const double x38 = f01*f02;
    const double x39 = f11*f12;
    const double x40 = f21*f22;
    const double x41 = lambda*x38 + mu*(2*x38 + x39 + x40);
    const double x42 = f11*mu;
    const double x43 = f01*lambda;
    const double x44 = f00*x42 + f10*x43;
    const double x45 = lambda*x24 + mu*(x23 + 2*x24 + x25);
    const double x46 = f02*x42 + f12*x43;
    const double x47 = f21*mu;
    const double x48 = f00*x47 + f20*x43;
    const double x49 = lambda*x32 + mu*(x31 + 2*x32 + x33);
    const double x50 = f02*x47 + f22*x43;
    const double x51 = x8 - 1;
    const double x52 = x0 + x9;
    const double x53 = f12*mu;
    const double x54 = f02*lambda;
    const double x55 = f00*x53 + f10*x54;
    const double x56 = f01*x53 + f11*x54;
    const double x57 = lambda*x25 + mu*(x23 + x24 + 2*x25);
    const double x58 = f22*mu;
    const double x59 = f00*x58 + f20*x54;
    const double x60 = f01*x58 + f21*x54;
    const double x61 = lambda*x33 + mu*(x31 + x32 + 2*x33);
    const double x62 = lambda*x16 + mu*(x15 + 2*x16 + x17);
    const double x63 = lambda*x20 + mu*(x19 + 2*x20 + x21);
    const double x64 = f10*f20;
    const double x65 = f11*f21;
    const double x66 = f12*f22;
    const double x67 = lambda*x64 + mu*(2*x64 + x65 + x66);
    const double x68 = f10*lambda;
    const double x69 = f11*x35 + f21*x68;
    const double x70 = f12*x35 + f22*x68;
    const double x71 = lambda*x39 + mu*(x38 + 2*x39 + x40);
    const double x72 = f11*lambda;
    const double x73 = f20*x72 + f21*x28;
    const double x74 = lambda*x65 + mu*(x64 + 2*x65 + x66);
    const double x75 = f12*x47 + f22*x72;
    const double x76 = x11 + x9;
    const double x77 = f12*lambda;
    const double x78 = f20*x77 + f22*x28;
    const double x79 = f21*x77 + f22*x42;
    const double x80 = lambda*x66 + mu*(x64 + x65 + 2*x66);
    const double x81 = lambda*x17 + mu*(x15 + x16 + 2*x17);
    const double x82 = lambda*x21 + mu*(x19 + x20 + 2*x21);
    const double x83 = lambda*x40 + mu*(x38 + x39 + 2*x40);

    out.resize(9, 9);
    out(0, 0) = lambda*x0 + mu*(3*x0 + x3 + x7) + x14;
    out(0, 1) = x18;
    out(0, 2) = x22;
    out(0, 3) = x26;
    out(0, 4) = x29;
    out(0, 5) = x30;
    out(0, 6) = x34;
    out(0, 7) = x36;
    out(0, 8) = x37;
    out(1, 0) = x18;
    out(1, 1) = lambda*x1 + mu*(3*x1 + x13 + x6) + x14;
    out(1, 2) = x41;
    out(1, 3) = x44;
    out(1, 4) = x45;
    out(1, 5) = x46;
    out(1, 6) = x48;
    out(1, 7) = x49;
    out(1, 8) = x50;
    out(2, 0) = x22;
    out(2, 1) = x41;
    out(2, 2) = lambda*x5 + mu*(x1 + 3*x5 + x51 + x52) + x14;
    out(2, 3) = x55;
    out(2, 4) = x56;
    out(2, 5) = x57;
    out(2, 6) = x59;
    out(2, 7) = x60;
    out(2, 8) = x61;
    out(3, 0) = x26;
    out(3, 1) = x44;
    out(3, 2) = x55;
    out(3, 3) = lambda*x2 + mu*(x12 + 3*x2 + x4 + x51) + x14;
    out(3, 4) = x62;
    out(3, 5) = x63;
    out(3, 6) = x67;
    out(3, 7) = x69;
    out(3, 8) = x70;
    out(4, 0) = x29;
    out(4, 1) = x45;
    out(4, 2) = x56;
    out(4, 3) = x62;
    out(4, 4) = lambda*x11 + mu*(x10 + 3*x11 + x3 + x51) + x14;
    out(4, 5) = x71;
    out(4, 6) = x73;
    out(4, 7) = x74;
    out(4, 8) = x75;
    out(5, 0) = x30;
    out(5, 1) = x46;
    out(5, 2) = x57;
    out(5, 3) = x63;
    out(5, 4) = x71;
    out(5, 5) = lambda*x8 + mu*(x2 + x6 + x76 + 3*x8) + x14;
    out(5, 6) = x78;
    out(5, 7) = x79;
    out(5, 8) = x80;
    out(6, 0) = x34;
    out(6, 1) = x48;
    out(6, 2) = x59;
    out(6, 3) = x67;
    out(6, 4) = x73;
    out(6, 5) = x78;
    out(6, 6) = lambda*x4 + mu*(x10 + x2 + 3*x4 + x52 - 1) + x14;
    out(6, 7) = x81;
    out(6, 8) = x82;
    out(7, 0) = x36;
    out(7, 1) = x49;
    out(7, 2) = x60;
    out(7, 3) = x69;
    out(7, 4) = x74;
    out(7, 5) = x79;
    out(7, 6) = x81;
    out(7, 7) = lambda*x10 + mu*(x1 + 3*x10 + x4 + x76 - 1) + x14;
    out(7, 8) = x83;
    out(8, 0) = x37;
    out(8, 1) = x50;
    out(8, 2) = x61;
    out(8, 3) = x70;
    out(8, 4) = x75;
    out(8, 5) = x80;
    out(8, 6) = x82;
    out(8, 7) = x83;
    out(8, 8) = lambda*x9 + mu*(x10 + x7 + x8 + 3*x9) + x14;

}
